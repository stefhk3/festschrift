\documentclass[review]{elsarticle}

\usepackage{lineno,hyperref}
%\usepackage{lineno}
\modulolinenumbers[5]

\journal{Journal of Theoretical Computer Science}

%%%%%%%%%%%%%%%%%%%%%%%
%% Elsevier bibliography styles
%%%%%%%%%%%%%%%%%%%%%%%
%% To change the style, put a % in front of the second line of the current style and
%% remove the % from the second line of the style you would like to use.
%%%%%%%%%%%%%%%%%%%%%%%

%% Numbered
%\bibliographystyle{model1-num-names}

%% Numbered without titles
%\bibliographystyle{model1a-num-names}

%% Harvard
%\bibliographystyle{model2-names.bst}\biboptions{authoryear}

%% Vancouver numbered
%\usepackage{numcompress}\bibliographystyle{model3-num-names}

%% Vancouver name/year
%\usepackage{numcompress}\bibliographystyle{model4-names}\biboptions{authoryear}

%% APA style
%\bibliographystyle{model5-names}\biboptions{authoryear}

%% AMA style
%\usepackage{numcompress}\bibliographystyle{model6-num-names}
\usepackage{amsmath}
\usepackage{psfrag}
\usepackage{graphicx}
\usepackage{epsfig}
\usepackage{epstopdf}
\usepackage{amssymb}
\usepackage{bm}
\usepackage[dvipsnames]{xcolor}
\usepackage{mathtools}

%% `Elsevier LaTeX' style
\bibliographystyle{elsarticle-num}
%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\paral}{\; \vert \;}
\newcommand{\myvec}[1]{\overrightarrow{#1}}
\newcommand{\Defeq}{\stackrel{\mathrm{df}}{=}}
\newcommand{\Bnfeq}{::=}
\newcommand{\Co}[1]{\overline{#1}}

%
\newcommand{\Bsep}{\: \mid \: }
\newcommand{\Rule}[2]{\displaystyle{\frac{#1}{#2}}}
\newcommand{\SF}[1]{\mathsf{#1}}
\newcommand{\Act}{\mathsf{Act}}
\newcommand{\Vis}{\mathsf{Vis}}
\newcommand{\ActK}{\mathsf{ActK}}
\newcommand{\Proc}{\mathsf{Proc}}
\newcommand{\Procc}{\mathsf{ProcC}}
\newcommand{\Pred}{\mathsf{Pred}}
\newcommand{\Std}{\mathsf{Std}}
\newcommand{\rms}{\mathrm{S}}
\newcommand{\rmrec}{\mathrm{rec}}
\newcommand{\rmreck}{\mathrm{reck}}
\newcommand{\rmreckR}{\mathrm{reckR}}
\newcommand{\rma}{\mathrm{A}}
\newcommand{\rmp}{\mathrm{P}}
\newcommand{\rmf}{\mathrm{F}}
\newcommand{\rmr}{\mathrm{R}}
\newcommand{\rmfr}{\mathrm{FR}}
\newcommand{\equivS}{\equiv_{\mathrm{S}}}
\newcommand{\SigSA}{\Sigma_{\mathrm{SA}}}
\newcommand{\ltran}[1]{\stackrel{#1}{\longrightarrow}}
\newcommand{\tran}[1]{\stackrel{#1}{\rightarrow}}
\newcommand{\nottran}[1]{\stackrel{#1}{\not\rightarrow}}
\newcommand{\Rtran}[1]{\stackrel{#1}{\rightsquigarrow}}
\newcommand{\notRtran}[1]{\stackrel{#1}{\not\rightsquigarrow}}
\newcommand{\trans}[1]{\stackrel{#1}{\rightarrow}_{\mathrm{S}}}
\newcommand{\Par}{\mid}
\newcommand{\Mid}{\!\mid\!}
\newcommand{\restrict}[1]{\!\setminus\!#1}

\newcommand{\mA}{\mathcal{A}}
\newcommand{\mSA}{\mathcal{SA}}
\newcommand{\mWA}{\mathcal{WA}}
\newcommand{\mAK}{\mathcal{AK}}
\newcommand{\aAK}{\mathcal{(A)K}}
\newcommand{\umAK}{\underline{\mathcal{A}}\mathcal{K}}
\newcommand{\un}[1]{\underline {#1}}
\newcommand{\PI}{\mathcal{PI}}
\newcommand{\rom}[1]{\mbox{\rm{#1}}}

\newcommand{\Nil}{\mathbf{0}}
\newcommand{\New}[1]{\nu#1\: }
\newcommand{\Str}{\equiv}
\newcommand{\stdpred}{\mathsf{std}}
\newcommand{\std}[1]{\mathsf{std}(#1)}
%
\newcommand{\Bch}[2]{\mathsf{before}_{#1}(#2)}

\newcommand{\keys}[1]{\mathsf{keys}(#1)}
\newcommand{\kkey}[1]{\mathsf{k}(#1)}
\newcommand{\key}[1]{[#1]}
\newcommand{\Keys}{\mathcal{K}}
\newcommand{\freshpred}[1]{\mathsf{fsh}[#1]}
\newcommand{\fresh}[2]{\mathsf{fsh}[#1](#2)}

\newcommand{\ta}[1]{\mathsf{ta}(#1)}
\newcommand{\action}[1]{\mathsf{act}(#1)}

\newcommand{\intr}{\mbox{\ $\hat{}$\ }}
%\newcommand{\intr}{\mbox{\; $\widehat{}$\;}}
\newcommand{\sterm}{\mathsf{trm}}
\newcommand{\Sterm}[1]{\sterm(#1)}
\newcommand{\und}[1]{\underline{#1}}
\newcommand{\sqc}{\mathop{\cdot}}
\newcommand{\card}[1]{|#1|}
\newcommand{\bydef}{\stackrel{\emph{def}}{=}}
%
\newcommand{\Angle}[1]{\langle #1 \rangle}
\newcommand{\Tri}{\triangleright}
%\newcommand{\hole}{\bullet}
\newcommand{\hole}{[\ ]}
\newcommand{\rec}[1]{\mathrm{rec}\, #1}
\newcommand{\Rec}[1]{\rec #1 .}
\newcommand{\Rch}{\mathsf{Rch}}
\newcommand{\prune}{\pi}
\newcommand{\Prune}[1]{\prune(#1)}
\newcommand{\Root}[1]{\mathsf{rt}(#1)}

\newcommand{\Bis}{\sim}
\newcommand{\Biss}{\Bis_{\mathsf{S}}}
\newcommand{\Bisf}{\Bis_{\mathsf{F}}}
\newcommand{\Bisfr}{\Bis_{\mathsf{FR}}}
%\newcommand{\Bisu}{\Bis_{\Un}}
\newcommand{\Sim}{\mathcal{S}}
\newcommand{\Rem}{\backslash}
\newcommand{\sqeqt}{\sim}
% rules:
% static rule
\newcommand{\one}{\mbox{(I)}}
\newcommand{\onef}{\mbox{(1)}}
\newcommand{\oner}{\mbox{(1R)}}
% choice rule
\newcommand{\two}{\mbox{(II)}}
\newcommand{\twof}{\mbox{(2)}}
\newcommand{\twor}{\mbox{(2R)}}
% choice axiom
\newcommand{\thr}{\mbox{(III)}}
\newcommand{\thrf}{\mbox{(3)}}
\newcommand{\thrr}{\mbox{(3R)}}
\newcommand{\thrpf}{\mbox{(3\,$'$\!)}}
\newcommand{\thrpr}{\mbox{(3\,$'$\!R)}}
%
%
\newcommand{\Draft}[1]{}
\newcommand{\Comment}[1]{}
\newcommand{\Rev}[1]{{#1}^{-1}}
\newcommand{\rulename}[1]{\textsf{#1}}

\newcommand{\Blue}[1]{\textcolor{blue}{#1}}
%\newcommand{\Red}[1]{#1}
\newcommand{\Red}[1]{\textcolor{red}{#1}}
%
\newcommand{\DP}{\mathit{DP}}
\newcommand{\Me}{\mathit{Me}}
\newcommand{\Meprime}{\mathit{Me'}}
\newcommand{\MutS}{\mathit{MutS}}
\newcommand{\MutSprime}{\mathit{MutS'}}
\newcommand{\MutL}{\mathit{MutL}}
\newcommand{\MutH}{\mathit{MutH}}
\newcommand{\UvrD}{\mathit{UvrD}}
%

\newtheorem{theorem}{Theorem}
\newtheorem{definition}{Definition}
\newtheorem{remark}{Remark}
\newtheorem{example}{Example}
\newtheorem{proposition}{Proposition}
%
\newcommand{\xxrightarrow}{\xmapsto}

%

\begin{document}

\begin{frontmatter}

\title{Modelling of DNA Mismatch Repair with a reversible process calculus\tnoteref{mytitlenote}}
%\tnotetext[mytitlenote]{Fully documented templates are available in the elsarticle package on \href{http://www.ctan.org/tex-archive/macros/latex/contrib/elsarticle}{CTAN}.}

%% Group authors per affiliation:
\author{Stefan Kuhn}%\fnref{myfootnote}}
\address{School of Computer Science and Informatics, De Montfort University, Leicester, UK}
\ead{stefan.kuhn@dmu.ac.uk}
%\fntext[myfootnote]{Since 1880.}

\author{Irek Ulidowski}%\fnref{myfootnote}}
\address{School of Computing and Mathematical Sciences, University of Leicester, Leicester, UK}
\ead{iu3@leicester.ac.uk}

%\fntext[myfootnote]{Since 1880.}
%% or include affiliations in footnotes:
%\author[mymainaddress,mysecondaryaddress]{Elsevier Inc}
%\ead[url]{www.elsevier.com}

%\author[mysecondaryaddress]{Global Customer Service\corref{mycorrespondingauthor}}
%\cortext[mycorrespondingauthor]{Corresponding author}
%\ead{support@elsevier.com}
%
%\address[mymainaddress]{1600 John F Kennedy Boulevard, Philadelphia}
%\address[mysecondaryaddress]{360 Park Avenue South, New York}

\begin{abstract}
%We have demonstrated in previous work that the Calculus of Covalent Bonding (CCB) can be used to simulate higher-level biochemical processes. This is significant since CCB was originally devised to model organic chemical reactions on a lower level. We are now extending the use of CCB to model another gene repair pathway, DNA Mismatch Repair (MMR). This is a more complex pathway than the Base Excision Repair (BER) which we modelled originally. It involves four proteins and needs a distinction between the two chains in a DNA strand. We demonstrate that we can model this by extending our modelling of BER and that we can do this using the unchanged CCB calculus and operational semantics. We also show that the simulation software developed previously can be used to execute this pathway.
%
%
We have demonstrated in previous work that the Calculus of Covalent Bonding (CCB) can be used to simulate higher-level biochemical processes. This is significant since CCB was originally devised to model lower level organic chemical reactions. In this paper we extend the use of the calculus  to model an important gene repair pathway, namely DNA Mismatch Repair (MMR). This complex pathway involves four helper proteins and needs a distinction between the two chains in a DNA strand. 
In order to achieve this, we extend the calculus by allowing prefixing with collections of bonding sites.
% and its operational semantics by allowing more complex concerted actions transitions.
% We also show that the simulation software developed previously can be used to execute this pathway.
\end{abstract}

\begin{keyword}Reversible computation, Calculus of Covalent Bonding, DNA Mismatch Repair.
%\texttt{elsarticle.cls}\sep \LaTeX\sep Elsevier \sep template
%\MSC[2010] 00-01\sep  99-00
\end{keyword}

\end{frontmatter}

\linenumbers

\section{Introduction}

We have previously introduced a Calculus of Covalent  Bonding (CCB) \cite{KU16,KU2017} to models the formation and breaking of covalent bonds. % in organic molecules. 
CCB contains the possibility to link forming and breaking of bonds, thus enabling integrated, local control of reversibility. This feature allows us to represent both standard reversibility as well as \emph{out-of-causal order} reversibility~\cite{Irek2012}. In order to demonstrate the basics of our calculus we show how to model the autoprotlysis of water, which transfers a proton between two water molecules. 
%Since the reaction takes place in water it is also known as autoprotolysis of water. 
This reversible reaction is shown in Figure~\ref{fig:autoprotolysis}.
%
\begin{figure}
\centering
\includegraphics[height=2cm]{autoprotolysis}
\caption{Autoprotolysis of water.}
\label{fig:autoprotolysis}
\end{figure}

The main factor in the reaction is that oxygen is \emph{nucleophilic}, so it attracts electrons. This makes the hydrogen atoms in water
have a positive partial charge and the oxygen atoms a negative partial charge, attracting each other. Due to the nucleophilicity of 
oxygen, a covalent bond can form between them. This bond is formed out of electrons in the outer shell of the oxygen atom not used in bonds so far. Since a hydrogen atom cannot have more than one bond the creation of a new bond is compensated by breaking of the existing hydrogen-oxygen bond.
These reactions are \emph{concerted}, namely they happen together without a stable intermediate configuration. As a result we have reached the state where one oxygen has three covalent bonds to hydrogens and is positively charged,
and the other oxygen bonds to only one hydrogen and is negatively charged. The reaction is reversible: the oxygen, which has lost a hydrogen, can 
pull back one of the hydrogens from the other water.

We now outline the modelling of the reaction in CCB.  % to remind the reader of the basics of CCB. 
We model the hydrogen and oxygen atoms as processes $H$ and $O$ below, where 
$h,o$ are actions representing the bonding capabilities of the atoms and $n,p$ 
represent negative and positive charges respectively. $H',O'$ are process constants.
$$\begin{array}{lll}
H & \bydef & (h;p).H'\\
O & \bydef & (o,o,n).O'
\end{array}$$
We use a general prefixing construct $(s;b).P$ where $s$ is a sequence of actions or executed 
actions, and $b$ is a \emph{weak} action. Sometime the weak action is omitted 
(as in the definition of $O$). Informally, an action in $s$ can take place in any order, 
and $b$ can happen if
all actions in $s$ have already taken place. Once $b$ takes place, it must be accompanied by
undoing immediately one of the actions in $s$ (and thus possibly breaking a bond). We shall later extend
this prefixing operator to permit multiple bonding sites as in $((s;b)\mid \cdots\mid (s';b')).P$.

We use a synchronisation function $\gamma$ which tells us which actions can combine to 
produce bonds between atoms:
$$\begin{array}{lllllllllllllllll}
\gamma(h,o) = ho \quad &
\gamma(n,p) = np \quad &
\gamma(n,h) = nh\quad  &
\gamma(n,o) = no 
\end{array}$$
Each water molecule is a structure consisting of two hydrogen atoms and one oxygen atom 
which are bonded appropriately. 
$$( (h_1[1];p).H'_1 \paral (h_2[2];p).H'_2 \paral (o_1[1],o_2[2],n).O'_1)\setminus\{h_1,h_2,o_1,o_2\}$$
We have used subscripts to name the individual copies of 
atoms and actions. The system of two water molecules in Figure~\ref{fig:autoprotolysis} is represented 
by placing them in parallel and restricting actions $n$ and $p$. This is represented by  
the following process, where restrictions are moved outside using structural congruence laws:
\begin{flalign*}
& ( (h_1[1];p).H'_1 \paral (h_2[2];p).H'_2 \paral (o_1[1],o_2[2],n).O'_1 \paral \\ 
&\paral  (h_3[3];p).H'_3 \paral (h_4[4];p).H'_4  \paral (o_3[3],o_4[4],n).O'_2) 
\setminus\{h_3,h_4,o_3,o_4,h_1,h_2,o_1,o_2,n,p\}
\end{flalign*}
Now actions $n$ and $p$ of different water molecules can combine, representing a transfer of a proton from one atom 
of oxygen to another oxygen. We show below the transfer from $O_2$ to $O_1$, using the \emph{concerted actions} feature of CCB, where the actions to bond are indicated in bold blue and the bond to be broken is in bold red.
\begin{flalign*}
& ( (h_1[1];p).H'_1 \paral (h_2[2];p).H'_2 \paral (o_1[1],o_2[2],\Blue{\bm{n}}).O'_1 \paral 
(\Red{\bm{h_3[3]}};\Blue{\bm{p}}).H'_3 \\
&\paral (h_4[4];p).H'_4  \paral (\Red{\bm{o_3[3]}},o_4[4],n).O'_2) 
\setminus\{h_3,h_4,o_3,o_4,h_1,h_2,o_1,o_2,n,p\}\\
%
&\xrightarrow{\{ np[5], \underline{h_{3}o_{3}}[3]\}} \\
%
&( (h_1[1];p).H'_1 \paral (h_2[2];p).H'_2 \paral (o_1[1],o_2[2],\bm{n[5]}).O'_1 \paral 
(\bm{h_3};\bm{p[5]}).H'_3 \\
&\paral (h_4[4];p).H'_4  \paral (\bm{o_3},o_4[4],n).O'_2) 
\setminus\{h_3,h_4,o_3,o_4,h_1,h_2,o_1,o_2,n,p\}
\end{flalign*}

Since $H_3$ is weakly bonded to $O_1$ and its strong capability 
$h_3$ has become available, the bond $5$ gets promoted to a stronger bond, releasing 
the capability $p$ of $H_3$. This is done by the application of CCB's promotion rule:
\begin{flalign*}
\Rightarrow\; &( (h_1[1];p).H'_1 \paral (h_2[2];p).H'_2 \paral (o_1[1],o_2[2],n[5]).O'_1 \paral 
(h_3[5];p).H'_3 \\
&\paral (h_4[4];p).H'_4  \paral (o_3,o_4[4],n).O'_2) 
\setminus\{h_3,h_4,o_3,o_4,h_1,h_2,o_1,o_2,n,p\}
\end{flalign*}

We have now arrived at the state on the right hand side in Figure~\ref{fig:autoprotolysis}.
Oxygen $O_1$ is blocked, which represents it being fully bonded (and positively charged).
Oxygen  $O_2$ has a free $n$ capability and can abstract any of the hydrogens from $O_1$. 
As a result the process can reverse to its original state or to equivalent states where
different hydrogen atoms are bonded to $O_1$ and $O_2$.

In this paper, we model DNA mismatch repair using CCB. This builds upon and extends our previous work on the modelling of BER and other biochemical reactions~\cite{10.1007/978-3-319-99498-7_8}  and shows that the mechanisms in CCB are relevant outside its original application area. 

Deoxyribonucleic acid (DNA) carries the essential information for the working of all known organisms. It is composed of two polynucleotide chains. Each nucleotide contains one of the four nucleobases, or simply bases,  adenine (A), cytosine (C), guanine (G), and thymine (T). 
The bases can react with each other as follows: A and T produce a pair A-T, C and G produce a pair C-G,
and other combinations are not normally possible. This property means that each of the two polynucleotide chains of a DNA contains the same biological information, but expressed differently. It also enables DNA replication. 
DNA can split into two chains and then each chain can be completed with the matching bases, so that each new DNA is an identical copy of the original strand. Replication in turn enables the multiplication of cells and growth.

In reality DNA can be imperfect. This could be due either to external factors, such as radiation 
%(the reason why nuclear radition is damaging long-term) 
or internal factors, such as free radicals produced by the body. Another source of DNA errors are problems during replication. For example, it can happen that adenine in one chain faces guanine in the other chain when it should normally be matched by a thymine. Figure~\ref{fig:damages} shows such a mismatch on the right: The combination of the A/G bases is incorrect. Another error is an incorporation of a uracil base (U) in a DNA chain, which would normally not occur in DNA, is shown on the left in Figure~\ref{fig:damages}. A repair mechanism for this error, called Base Excision Repair (BER), was modelled in \cite{10.1007/978-3-319-99498-7_8} using our Calculus of Covalent Bonding (CCB).

\begin{figure}[h!]
  \centering
    \includegraphics[width=1.0\textwidth]{Types_of_DNA_Damage_part}
  \caption[Two types of DNA damage.]{Two types of DNA damage. The right half shows a DNA mismatch.
  % (the example used here). 
  On the left, the incorporation of a Uracil base is shown.
  %, which was modelled in \cite{10.1007/978-3-319-99498-7_8}. 
  Part of \href{https://commons.wikimedia.org/wiki/File:Types_of_DNA_Damage.jpg}{Image} by Chantelmao, licensed under \href{https://creativecommons.org/licenses/by-sa/4.0/deed.en}{CC-BY-SA-4.0}.}
  \label{fig:damages}
\end{figure}

DNA repair is crucial to maintain the quality of information in organisms. Whilst DNA replication errors are rare (they happen at a rate of about 1 per every 100,000 nucleotides), this translates to a large number of errors given the length of DNA: about 120,000 mistakes every time a human cell divides~\cite{damage}. There are other sources of DNA damage, and also a multitude of repair mechanisms. We focus in this paper on a particular type of replication error called DNA Mismatch Repair (MMR) and its repair. Since incorrect DNA can give rise to cancer and other illnesses and generally to early ageing and death, DNA repair is a crucial part of life and its understanding is an important research topic.
%
We shall model around 30 molecules involved in the MMR system, and represent the reactions of the mechanism as transitions of the MMR system. On the one hand, this is a continuation of the biochemical modelling in our previous work and, on the other hand, it provides an opportunity to further test and evaluate CCB.  
A significant advantage of CCB is that it allows to represent out-of-causal order reversibility~\cite{Irek2012}, where causes are seemingly undone before their effects are undone, which is common in biochemical reactions.

%\Red{For modelling such situations, CCB is useful since it enables out-of-causal order reversibility. This is needed to model processes like the one on the rigtht in Figure~\ref{fig:introexample}. Here, a bond to one element (for example A) is needed when the bond to the nexte element (for example B) is formed to avoid losing the connection completely. Only once the new connection is formed, the old one can be released, which is out-of-causal order. A good modelling in a calculus requering causal consistency is not possible.}
%}

\section{Related Work}
\input{CCB-related.tex}
%
\section{A Calculus of Covalent Bonding}\label{sec:calculus}
\input{CCB-calculus.tex}
%
%\section{Base Excision Repair}
%\label{sec:ber}
%\include{CCB-ber}
%
\section{DNA Mismatch Repair}\label{sec:dnamimatch}
\input{CCB-mmr.tex}
%
\section{Conclusion}

In this paper, we have used a Calculus of Covalent Bonding  to model an important gene repair pathway, namely the DNA Mismatch Repair (MMR) mechanism. Since the molecules that we have considered, and reactions between them, are more complex than simple compounds of atoms (as in our previous applications), we have extended the calculus with a prefix operator that can represent multiple bonding sites. We have discovered that we can model adequately creation and breaking of bonds (that appear in the out-of-causal order fashion) involving two bonds (as is the case in covalent reactions). However, when a bond is created on two weak actions, this sometime requires instantaneous breaking of two bonds, as, for example, when $\UvrD$ bonds with $\DP_{11}$. This we cannot model directly in CCB. Instead, we use two transitions but can also use a shorthand notation via our
\rulename{concert3} rule. We intend to re-develop the operational semantics for the extended CCB so that both two action 
and three action concerted transitions are allowed. This will also involve adding a suitable choice operator and 
producing a fuller set of reduction rules especially for the restriction operator.   


The MMR mechanism is a complex pathway. We have modelled it with twelve deoxyribose/phosphate groups, twelve bases and four helper proteins, all composed in parallel. We then have shown successfully a sequence of transitions (representing bonding reactions and cascades of concerted reactions with either two or three reactions each) that represent the MMR mechanism. As stated above, we have used a shortcut rule \rulename{concert3}, which only is an approximation of how such reactions happen in reality. We have not been able to consider spatial aspects of such reactions in the current version of CCB, which is left to future research. Reaction rates is another useful addition to CCB and its simulator that we would be interested to develop in the future. 
%Overall, we would like to think that we have been able to demonstrate usefulness of CCB outside its immediate application domain.

\bibliography{mybibfile}

\end{document}